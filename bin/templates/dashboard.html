<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"></meta>
<title th:inline="text">[[#{app.name}]] :: Dashboard</title>

<link href="http://cdn.jsdelivr.net/webjars/bootstrap/3.3.6/css/bootstrap.min.css"
	th:href="@{/webjars/bootstrap/3.3.6/css/bootstrap.min.css}" rel="stylesheet" media="screen"
/>

<link rel="stylesheet" th:href="@{/css/application.css}" />

<script src="http://cdn.jsdelivr.net/webjars/jquery/2.1.3/jquery.min.js" th:src="@{/webjars/jquery/2.1.3/jquery.min.js}"></script>
<script th:src="@{/js/script.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>

<link rel="icon" th:href="@{/images/oops.ico}" />

</head>

<body>
	<div th:replace="fragments/header :: header"></div>

	<div class="container">

		<div th:if="${#lists.isEmpty(clusterData)}" class="alert alert-warning alert-dismissible" role="alert">
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
			<strong>Warning!</strong>
			There are no antiSMASH Zip Files uploaded in this session. Click
			<a th:href="@{/}" class="alert-link">here</a>
			to upload your files...
		</div>

		<h1 align="center" th:inline="text">Prioritisation Dashboard</h1>
		<div class="panel panel-default">
			<div class="panel-body">

				<div id="parameters" class="div-ctr div-border">
					<span>Select the parameter weight based on your desired output interests:</span>
					<br />
					<br />

					<form class="form-inline">
						<div class="form-group div-ctr">
							<label for="numberOfGenes">Number of Genes</label>
							<input type="range" class="sld" value="10" min="0" max="10" step="1" id="numberOfGenes"
								onInput="updateRangeValue(this, 'nogValue')"
							/>
							<output id="nogValue">10</output>
							<br />
							<label>
								<input type="checkbox" id="ignoreNOG" onClick="toggleRangeDisabling('numberOfGenes', 'nogValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('nogOrder');">
								<span id="nogOrder" class="glyphicon glyphicon-sort-by-attributes-alt"></span>
							</a>
							<input type="hidden" id="nogOrderValue" value="d" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr">
							<label for="sequenceLength">CDS Length</label>
							<input type="range" class="sld" value="10" min="0" max="10" step="1" id="sequenceLength"
								onInput="updateRangeValue(this, 'slValue')"
							/>
							<output id="slValue">10</output>
							<br />
							<label>
								<input type="checkbox" id="ignoreSL" onClick="toggleRangeDisabling('sequenceLength', 'slValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('slOrder');">
								<span id="slOrder" class="glyphicon glyphicon-sort-by-attributes-alt"></span>
							</a>
							<input type="hidden" id="slOrderValue" value="d" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr">
							<label for="gcContent">Coding GC</label>
							<input type="range" class="sld" value="10" min="0" max="10" step="1" id="gcContent"
								onInput="updateRangeValue(this, 'gccValue')"
							/>
							<output id="gccValue">10</output>
							<br />
							<label>
								<input type="checkbox" id="ignoreGCC" onClick="toggleRangeDisabling('gcContent', 'gccValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('gccOrder');">
								<span id="gccOrder" class="glyphicon glyphicon-sort-by-attributes-alt"></span>
							</a>
							<input type="hidden" id="gccOrderValue" value="d" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr">
							<label for="codonBias">Codon Bias</label>
							<input type="range" class="sld" value="10" min="0" max="10" step="1" id="codonBias"
								onInput="updateRangeValue(this, 'cbValue')"
							/>
							<output id="cbValue">10</output>
							<br />
							<label>
								<input type="checkbox" id="ignoreCB" onClick="toggleRangeDisabling('codonBias', 'cbValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('cbOrder');">
								<span id="cbOrder" class="glyphicon glyphicon-sort-by-attributes"></span>
							</a>
							<input type="hidden" id="cbOrderValue" value="a" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-left">
							<div class="div-ctr">
								<b>Reference Species</b>
							</div>
							<br />
							<label for="speciesName">Search&nbsp;</label>
							<input class="form-control input-sm" type="text" size="42" id="speciesName" placeholder="Reference species name..." />
							&nbsp;
							<a href="#" onclick="loadSpecies();">
								<span class="glyphicon glyphicon-search"></span>
							</a>
							<br />
							<br />
							<div id="speciesDD"></div>
						</div>

						<br />
						<br />
						<br />

						<div class="form-group div-ctr">
							<label for="preferredType">Preferred Cluster Type</label>
							<br />
							<select multiple="multiple" style="width: 150px" class="form-control" size="5" id="preferredType" th:field="*{typesList}">
								<option th:each="type : ${typesList}" th:value="${type}" th:text="${#strings.capitalize(type)}"></option>
							</select>
							<br />
							<br />
							<label>
								<input type="checkbox" id="ignorePT" onclick="toggleDisabling('preferredType')" />
								Ignore
							</label>
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr">
							<label for="knownClustersSimilarity">Known Clusters Similarity</label>
							<input type="range" class="sld-lg" value="10" min="0" max="10" step="1" id="knownClustersSimilarity"
								onInput="updateRangeValue(this, 'kcsValue')"
							/>
							<output id="kcsValue">10</output>
							<br />
							<label for="similarityPercentage">Preferred Similarity&nbsp;</label>
							<select class="form-control input-sm" id="similarityPercentage">
								<option value="0">0%</option>
								<option value="10">10%</option>
								<option value="20">20%</option>
								<option value="30">30%</option>
								<option value="40">40%</option>
								<option value="50">50%</option>
								<option value="60">60%</option>
								<option value="70">70%</option>
								<option value="80">80%</option>
								<option value="90">90%</option>
								<option selected="selected" value="100">100%</option>
							</select>
							<br />
							<br />
							<label>
								<input type="checkbox" id="ignoreKCS" onClick="toggleRangeDisabling('knownClustersSimilarity', 'kcsValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('kcsOrder');">
								<span id="kcsOrder" class="glyphicon glyphicon-sort-by-attributes"></span>
							</a>
							<input type="hidden" id="kcsOrderValue" value="a" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr">
							<label for="selfHomology">BGC Self-Homology</label>
							<input type="range" class="sld-lg" value="0" min="0" max="10" step="1" id="selfHomology"
								onInput="updateRangeValue(this, 'shValue')" disabled="disabled"
							/>
							<output id="shValue">0</output>
							<br />
							<label for="minimumMatch">Minimum Match&nbsp;</label>
							<select class="form-control input-sm" id="minimumMatch" disabled="disabled">
								<option value="7">7</option>
								<option value="9">9</option>
								<option value="11">11</option>
								<option value="13">13</option>
								<option selected="selected" value="15">15</option>
								<option value="17">17</option>
								<option value="19">19</option>
								<option value="21">21</option>
								<option value="23">23</option>
								<option value="25">25</option>
								<option value="27">27</option>
								<option value="29">29</option>
							</select>
							<br />
							<br />
							<label>
								<input type="checkbox" checked="checked" id="ignoreSH" onClick="toggleRangeDisabling('selfHomology', 'shValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('shOrder');">
								<span id="shOrder" class="glyphicon glyphicon-sort-by-attributes-alt"></span>
							</a>
							<input type="hidden" id="shOrderValue" value="d" />
						</div>

						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<div class="form-group div-ctr" style="margin-bottom: 10px;">
							<label for="phylogeneticDiversity">Phylogenetic Diversity</label>
							<input type="range" class="sld-lg" value="10" min="0" max="10" step="1" id="phylogeneticDiversity"
								onInput="updateRangeValue(this, 'pdValue')"
							/>
							<output id="pdValue">10</output>
							<br />
							<label>
								<input type="checkbox" id="ignorePD" onClick="toggleRangeDisabling('phylogeneticDiversity', 'pdValue');" />
								Ignore
							</label>
							&nbsp;
							<a href="#" onclick="toggleParameterOrdering('pdOrder');">
								<span id="pdOrder" class="glyphicon glyphicon-sort-by-attributes-alt"></span>
							</a>
							<input type="hidden" id="pdOrderValue" value="d" />
							<br />
							<br />
							&nbsp;
						</div>

						<br />
						<br />
						<div id="shAlert" style="display: none" class="alert alert-warning alert-dismissible" role="alert">
							<button type="button" class="close" onclick="$('#shAlert').hide()" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
							<div style="text-align: center">
								<strong>Warning!</strong>
								The BGC Self-Homology parameter triggers long running processes.
								<br />
								In order to minimise the prioritisation time it's strongly advised to use it in conjunction with the Preferred Cluster
								Type parameter.
							</div>
						</div>

						<button type="button" class="btn btn-primary btn-lg btn-block" onclick="prioritise()">PRIORITISE</button>
					</form>

				</div>

				<br />

				<div id="outputData">

					<table class="table table-striped">
						<thead>
							<tr>
								<th>#</th>
								<th>CLUSTER</th>
								<th>TYPE</th>
								<th>GENE #</th>
								<th>CDS LENGTH</th>
								<th>CODING GC</th>
								<th>CODON USAGE</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="cluster, iterStat : ${clusterData}">
								<th th:text="${iterStat.count}"></th>
								<td th:inline="text">
									<a th:href="@{|/local/${cluster.parent}/index.html#cluster-${cluster.clusterNumber}|}" target="_blank">[[${cluster.recordName}]]
										- Cluster [[${cluster.clusterNumber}]]</a>
								</td>
								<td th:text="${cluster.clusterType}"></td>
								<td th:text="${cluster.numberOfGenes}"></td>
								<td th:inline="text">[[${cluster.basePairs}]] bp</td>
								<td th:inline="text">[[${#numbers.formatDecimal(cluster.gcContent, 1, 2)}]]%</td>
								<td>
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<a th:href="@{|/codonTable/${cluster.name}|}" target="_blank">Open</a>
								</td>
							</tr>
						</tbody>
					</table>

				</div>

			</div>
		</div>

	</div>

	<div th:replace="fragments/footer :: footer"></div>
</body>
</html>